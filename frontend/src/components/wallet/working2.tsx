// xpub = 0396952911c77db5bf81e1a102cd21f50b95a40d0eb860d5bbc2fde4581bbef403
//  xpr = 7997a3e7c543e5ffa0c05482e4bba0dacd26ead1eb8dd13cff059090154330d5
// address = mpXKEnxxyfbQTN5NGETsCrHnMVZp4S8oyt
// heres a image I sent txid 9ef2b221dfac3095878886ed4e9045134146c16bd4df27c36081daf3174d5e7c

// ALIC TEST 
// alice ECDH 1st 2nd 3rd 4th 5th 
// 1st (12345789) 5a41b7b60e3528ce90120a75d6f7e023f13f70adf6c7b04eae70dbb6839d7c78
// 2nd d3230c92897b27a4c8cf45c1c70f541b2eb83456825747fb1e46ff715de775a0
// 3rd 06bf6489d3f6c07f7141a129c264a292ceddfe455d1e12bd2ae485807bf64e41
// 4th f956e89763aaf04de1812cc58ee066ff85b5dbc0d8c683fcc6aa36aa44a1439b
// 5th 7ad968d6e1e5ee4064aac68e1fb7f98d7d894d64f7188f339026405aaf9702be

// alice TYPE-42  1st 2nd 3rd 4th 5th 
// 1st e06447bb37d05d21faf387b85f97adcbb664fbf95fd665c5d1ae26d88da49b14
// 2nd 61ddf3a8938f170adb496fa7cc6a5310c000b3758c5b83d61205d8184de7eb7b
// 3rd 9e2509a4f2861dcc57ae2fee1f35eb87aa91b35ac391b3017f0b257fd86b67b8
// 4th f5b685edc04f18803e9e6d336cbe3304ee244e7503dc4f435e0b75aa0166c2df
// 5th 9b929504420e9a9ceaeae064d02ea9dd7a336326b04afc15831a57ca1bcf5210

// d3230c92897b27a4c8cf45c1c70f541b2eb83456825747fb1e46ff715de775a0
// 06bf6489d3f6c07f7141a129c264a292ceddfe455d1e12bd2ae485807bf64e41
// 7ad968d6e1e5ee4064aac68e1fb7f98d7d894d64f7188f339026405aaf9702be
// e06447bb37d05d21faf387b85f97adcbb664fbf95fd665c5d1ae26d88da49b14
/// TXID EXPORT FILE = 

//////////////////////////////
// bob test message = txid 4af8b76efa58275a18319b32532ab2493de30c93677d854888e4407f9a503958
{
  "version": "1.0",
  "exportDate": "2025-07-04T23:56:56.869Z",
  "network": "testnet",
  "messages": [
    {
      "txid": "5a41b7b60e3528ce90120a75d6f7e023f13f70adf6c7b04eae70dbb6839d7c78",
      "timestamp": "2025-07-04T23:56:03.000Z",
      "message": "123456789",
      "sender": "Alice Test",
      "recipient": "Unknown",
      "encrypted": "ea26181160f0d82ab44c3bb5c57235f2b86e573b0842768115e17b778570e8696ddecb99257114aeb8a7ee0f70c76e5915fbdb4403471aacdb",
      "isFromMe": false,
      "contactName": "Alice Test",
      "encryptionType": "standard"
    },
    {
      "txid": "d3230c92897b27a4c8cf45c1c70f541b2eb83456825747fb1e46ff715de775a0",
      "timestamp": "2025-07-04T23:56:03.000Z",
      "message": "2nd ",
      "sender": "Alice Test",
      "recipient": "Unknown",
      "encrypted": "8bb80674ef8d70719033dac99185834ffa5a68604a37d1773d0be32f637c5cd99a5795fbeba1bab6b5a443e9fe5acb3a4367b0ba",
      "isFromMe": false,
      "contactName": "Alice Test",
      "encryptionType": "standard"
    }
  ],
  "transactions": [
    {
      "txid": "c213a68a0a9c2ddc515df5d9487ff401de0c4a3f4f9fe30d043800005df28c9d",
      "detail": {
        "txid": "c213a68a0a9c2ddc515df5d9487ff401de0c4a3f4f9fe30d043800005df28c9d",
        "hash": "c213a68a0a9c2ddc515df5d9487ff401de0c4a3f4f9fe30d043800005df28c9d",
        "version": 1,
        "size": 191,
        "locktime": 0,
        "vin": [
          {
            "coinbase": "",
            "txid": "70493e8b0223672499650b6b8c6d4ee73913f9133e80a4c04606b1de1b4b055c",
            "vout": 55,
            "scriptSig": {
              "asm": "3044022053363339638cc193a4796ea2ef6a8cafcd01741429acc43e6a5d11c2cee82d3402203a41e4527322577f59b03800dc575d0b9b79bcbecc4198187b4f5f3b7ccee20b[ALL|FORKID] 0292acdb57c788c1e8c83cdb0ae8f23e079139ba7ba1bccf67b31653c7af12c4b4",
              "hex": "473044022053363339638cc193a4796ea2ef6a8cafcd01741429acc43e6a5d11c2cee82d3402203a41e4527322577f59b03800dc575d0b9b79bcbecc4198187b4f5f3b7ccee20b41210292acdb57c788c1e8c83cdb0ae8f23e079139ba7ba1bccf67b31653c7af12c4b4"
            },
            "sequence": 4294967295
          }
        ],
        "vout": [
          {
            "value": 0.00099904,
            "n": 0,
            "scriptPubKey": {
              "asm": "OP_DUP OP_HASH160 62ca9d73628f115fecd7fe546060c7b3e081b8ce OP_EQUALVERIFY OP_CHECKSIG",
              "hex": "76a91462ca9d73628f115fecd7fe546060c7b3e081b8ce88ac",
              "reqSigs": 1,
              "type": "pubkeyhash",
              "addresses": [
                "mpXKEnxxyfbQTN5NGETsCrHnMVZp4S8oyt"
              ],
              "isTruncated": false
            }
          }
        ],
        "blockhash": "0000000003b8c586eec93c1c9258b82555e719306038d31b6c06ac4893a1b8dc",
        "confirmations": 3,
        "time": 1751672517,
        "blocktime": 1751672517,
        "blockheight": 1682491
      },
      "blockHeight": 1682491,
      "blockHash": "0000000003b8c586eec93c1c9258b82555e719306038d31b6c06ac4893a1b8dc",
      "confirmations": 3
    },
    {
      "txid": "c01b8a2618dd90bc0f2aa4f65088fd57207b261f6ba734549e71fbf43243e961",
      "detail": {
        "txid": "c01b8a2618dd90bc0f2aa4f65088fd57207b261f6ba734549e71fbf43243e961",
        "hash": "c01b8a2618dd90bc0f2aa4f65088fd57207b261f6ba734549e71fbf43243e961",
        "version": 1,
        "size": 192,
        "locktime": 0,
        "vin": [
          {
            "coinbase": "",
            "txid": "70493e8b0223672499650b6b8c6d4ee73913f9133e80a4c04606b1de1b4b055c",
            "vout": 56,
            "scriptSig": {
              "asm": "30450221009484c97170a66fe71a616d77be3e12999ec0bb879c5e4eb5ef4037c90dfb41d602203ff963be9dbf0a3a21111082c24238e004b1035f5db2705cf8e51df37b31dc3e[ALL|FORKID] 0292acdb57c788c1e8c83cdb0ae8f23e079139ba7ba1bccf67b31653c7af12c4b4",
              "hex": "4830450221009484c97170a66fe71a616d77be3e12999ec0bb879c5e4eb5ef4037c90dfb41d602203ff963be9dbf0a3a21111082c24238e004b1035f5db2705cf8e51df37b31dc3e41210292acdb57c788c1e8c83cdb0ae8f23e079139ba7ba1bccf67b31653c7af12c4b4"
            },
            "sequence": 4294967295
          }
        ],
        "vout": [
          {
            "value": 0.00099904,
            "n": 0,
            "scriptPubKey": {
              "asm": "OP_DUP OP_HASH160 62ca9d73628f115fecd7fe546060c7b3e081b8ce OP_EQUALVERIFY OP_CHECKSIG",
              "hex": "76a91462ca9d73628f115fecd7fe546060c7b3e081b8ce88ac",
              "reqSigs": 1,
              "type": "pubkeyhash",
              "addresses": [
                "mpXKEnxxyfbQTN5NGETsCrHnMVZp4S8oyt"
              ],
              "isTruncated": false
            }
          }
        ],
        "blockhash": "0000000003b8c586eec93c1c9258b82555e719306038d31b6c06ac4893a1b8dc",
        "confirmations": 3,
        "time": 1751672517,
        "blocktime": 1751672517,
        "blockheight": 1682491
      },
      "blockHeight": 1682491,
      "blockHash": "0000000003b8c586eec93c1c9258b82555e719306038d31b6c06ac4893a1b8dc",
      "confirmations": 3
    },
    {
      "txid": "d3230c92897b27a4c8cf45c1c70f541b2eb83456825747fb1e46ff715de775a0",
      "detail": {
        "txid": "d3230c92897b27a4c8cf45c1c70f541b2eb83456825747fb1e46ff715de775a0",
        "hash": "d3230c92897b27a4c8cf45c1c70f541b2eb83456825747fb1e46ff715de775a0",
        "version": 1,
        "size": 291,
        "locktime": 0,
        "vin": [
          {
            "coinbase": "",
            "txid": "c01b8a2618dd90bc0f2aa4f65088fd57207b261f6ba734549e71fbf43243e961",
            "vout": 0,
            "scriptSig": {
              "asm": "304402205be283e8e55bd08a7929c4dfbe33b2a11bc572d0cd81f4ce94f6bd6e0a6b558b02203fac01fdc7af2003e0a1c2de4e70cc4fb66518554263f54fd4b6de4e31822355[ALL|FORKID] 0396952911c77db5bf81e1a102cd21f50b95a40d0eb860d5bbc2fde4581bbef403",
              "hex": "47304402205be283e8e55bd08a7929c4dfbe33b2a11bc572d0cd81f4ce94f6bd6e0a6b558b02203fac01fdc7af2003e0a1c2de4e70cc4fb66518554263f54fd4b6de4e3182235541210396952911c77db5bf81e1a102cd21f50b95a40d0eb860d5bbc2fde4581bbef403"
            },
            "sequence": 4294967295
          }
        ],
        "vout": [
          {
            "value": 0,
            "n": 0,
            "scriptPubKey": {
              "asm": "OP_RETURN 19338bb80674ef8d70719033dac99185834ffa5a68604a37d1773d0be32f637c5cd99a5795fbeba1bab6b5a443e9fe5acb3a4367b0ba",
              "hex": "6a3619338bb80674ef8d70719033dac99185834ffa5a68604a37d1773d0be32f637c5cd99a5795fbeba1bab6b5a443e9fe5acb3a4367b0ba",
              "type": "nulldata",
              "opReturn": {
                "type": "OP_RETURN",
                "action": "",
                "text": "",
                "parts": [
                  "\u00193��\u0006t��pq�3�ɑ��O�Zh`J7�w=\u000b�/c|\\ٚW��롺���C��Z�:Cg��"
                ]
              },
              "isTruncated": false
            }
          },
          {
            "value": 0.00000546,
            "n": 1,
            "scriptPubKey": {
              "asm": "OP_DUP OP_HASH160 765bde6836a09907b199aaa22529c6472ff89077 OP_EQUALVERIFY OP_CHECKSIG",
              "hex": "76a914765bde6836a09907b199aaa22529c6472ff8907788ac",
              "reqSigs": 1,
              "type": "pubkeyhash",
              "addresses": [
                "mrJn5qwSmrx9LEQV2NYiZSzUCry6eB7Jt8"
              ],
              "isTruncated": false
            }
          },
          {
            "value": 0.00099357,
            "n": 2,
            "scriptPubKey": {
              "asm": "OP_DUP OP_HASH160 62ca9d73628f115fecd7fe546060c7b3e081b8ce OP_EQUALVERIFY OP_CHECKSIG",
              "hex": "76a91462ca9d73628f115fecd7fe546060c7b3e081b8ce88ac",
              "reqSigs": 1,
              "type": "pubkeyhash",
              "addresses": [
                "mpXKEnxxyfbQTN5NGETsCrHnMVZp4S8oyt"
              ],
              "isTruncated": false
            }
          }
        ],
        "blockhash": "0000000009f5c20cb8de5d38635ff918b802d9c7cb6d1a5cafc596af56488008",
        "confirmations": 1,
        "time": 1751673363,
        "blocktime": 1751673363,
        "blockheight": 1682494
      },
      "blockHeight": 1682494,
      "blockHash": "0000000009f5c20cb8de5d38635ff918b802d9c7cb6d1a5cafc596af56488008",
      "confirmations": 1
    },
    {
      "txid": "5a41b7b60e3528ce90120a75d6f7e023f13f70adf6c7b04eae70dbb6839d7c78",
      "detail": {
        "txid": "5a41b7b60e3528ce90120a75d6f7e023f13f70adf6c7b04eae70dbb6839d7c78",
        "hash": "5a41b7b60e3528ce90120a75d6f7e023f13f70adf6c7b04eae70dbb6839d7c78",
        "version": 1,
        "size": 297,
        "locktime": 0,
        "vin": [
          {
            "coinbase": "",
            "txid": "c213a68a0a9c2ddc515df5d9487ff401de0c4a3f4f9fe30d043800005df28c9d",
            "vout": 0,
            "scriptSig": {
              "asm": "3045022100885cb15020a8c35c196410df5e5e1d2829151c6df9c9f56117980db90196b2270220640a710ee0087874adb7048c9bb52b7e2dbb5d1937178f03893a1825ba1e4369[ALL|FORKID] 0396952911c77db5bf81e1a102cd21f50b95a40d0eb860d5bbc2fde4581bbef403",
              "hex": "483045022100885cb15020a8c35c196410df5e5e1d2829151c6df9c9f56117980db90196b2270220640a710ee0087874adb7048c9bb52b7e2dbb5d1937178f03893a1825ba1e436941210396952911c77db5bf81e1a102cd21f50b95a40d0eb860d5bbc2fde4581bbef403"
            },
            "sequence": 4294967295
          }
        ],
        "vout": [
          {
            "value": 0,
            "n": 0,
            "scriptPubKey": {
              "asm": "OP_RETURN 1933ea26181160f0d82ab44c3bb5c57235f2b86e573b0842768115e17b778570e8696ddecb99257114aeb8a7ee0f70c76e5915fbdb4403471aacdb",
              "hex": "6a3b1933ea26181160f0d82ab44c3bb5c57235f2b86e573b0842768115e17b778570e8696ddecb99257114aeb8a7ee0f70c76e5915fbdb4403471aacdb",
              "type": "nulldata",
              "opReturn": {
                "type": "OP_RETURN",
                "action": "",
                "text": "",
                "parts": [
                  "\u00193�&\u0018\u0011`��*�L;��r5��nW;\bBv�\u0015�{w�p�im�˙%q\u0014����\u000fp�nY\u0015��D\u0003G\u001a��"
                ]
              },
              "isTruncated": false
            }
          },
          {
            "value": 0.00000546,
            "n": 1,
            "scriptPubKey": {
              "asm": "OP_DUP OP_HASH160 765bde6836a09907b199aaa22529c6472ff89077 OP_EQUALVERIFY OP_CHECKSIG",
              "hex": "76a914765bde6836a09907b199aaa22529c6472ff8907788ac",
              "reqSigs": 1,
              "type": "pubkeyhash",
              "addresses": [
                "mrJn5qwSmrx9LEQV2NYiZSzUCry6eB7Jt8"
              ],
              "isTruncated": false
            }
          },
          {
            "value": 0.00099357,
            "n": 2,
            "scriptPubKey": {
              "asm": "OP_DUP OP_HASH160 62ca9d73628f115fecd7fe546060c7b3e081b8ce OP_EQUALVERIFY OP_CHECKSIG",
              "hex": "76a91462ca9d73628f115fecd7fe546060c7b3e081b8ce88ac",
              "reqSigs": 1,
              "type": "pubkeyhash",
              "addresses": [
                "mpXKEnxxyfbQTN5NGETsCrHnMVZp4S8oyt"
              ],
              "isTruncated": false
            }
          }
        ],
        "blockhash": "0000000009f5c20cb8de5d38635ff918b802d9c7cb6d1a5cafc596af56488008",
        "confirmations": 1,
        "time": 1751673363,
        "blocktime": 1751673363,
        "blockheight": 1682494
      },
      "blockHeight": 1682494,
      "blockHash": "0000000009f5c20cb8de5d38635ff918b802d9c7cb6d1a5cafc596af56488008",
      "confirmations": 1
    }
  ]
}







// 42421033030a2b652655cb93f00a5524fdd5af9fb2bd2aec545d6764f24689ea1550a559200260392349bb201143b89dfd0b0ad114e9e12dd154a38194ac7e23c0a626d4a99820f7eda0a148a29cba3ef8bfd383281f0c8c83ae113a1accf37c02c8119eba6de122bb24d0b0783d32298c5354
/// TYPE-42 BACK UP FILE EXPORT FILE =
{
  "version": "1.0",
  "walletId": "mpXKEnxx",
  "exportedAt": "2025-07-04T23:56:21.601Z",
  "invoiceNumbers": [
    [
      "02603923",
      [
        {
          "invoice": "2-msg-2025-07-04-02603923-1",
          "timestamp": 1751673275771,
          "txid": "e06447bb37d05d21faf387b85f97adcbb664fbf95fd665c5d1ae26d88da49b14"
        },
        {
          "invoice": "2-msg-2025-07-04-02603923-2",
          "timestamp": 1751673285388,
          "txid": "61ddf3a8938f170adb496fa7cc6a5310c000b3758c5b83d61205d8184de7eb7b"
        },
        {
          "invoice": "2-msg-2025-07-04-02603923-3",
          "timestamp": 1751673294264,
          "txid": "9e2509a4f2861dcc57ae2fee1f35eb87aa91b35ac391b3017f0b257fd86b67b8"
        },
        {
          "invoice": "2-msg-2025-07-04-02603923-4",
          "timestamp": 1751673306030,
          "txid": "f5b685edc04f18803e9e6d336cbe3304ee244e7503dc4f435e0b75aa0166c2df"
        },
        {
          "invoice": "2-msg-2025-07-04-02603923-5",
          "timestamp": 1751673315634,
          "txid": "9b929504420e9a9ceaeae064d02ea9dd7a336326b04afc15831a57ca1bcf5210"
        }
      ]
    ]
  ],
  "messageMetadata": [
    [
      "e06447bb37d05d21faf387b85f97adcbb664fbf95fd665c5d1ae26d88da49b14",
      {
        "v": "42v2",
        "i": "2-msg-2025-07-04-02603923-1",
        "d": "2-daily-2025-07-04",
        "t": 1751673275,
        "c": "e01ddf65",
        "storedAt": 1751673275783
      }
    ],
    [
      "61ddf3a8938f170adb496fa7cc6a5310c000b3758c5b83d61205d8184de7eb7b",
      {
        "v": "42v2",
        "i": "2-msg-2025-07-04-02603923-2",
        "d": "2-daily-2025-07-04",
        "t": 1751673285,
        "c": "c21365c7",
        "storedAt": 1751673285390
      }
    ],
    [
      "9e2509a4f2861dcc57ae2fee1f35eb87aa91b35ac391b3017f0b257fd86b67b8",
      {
        "v": "42v2",
        "i": "2-msg-2025-07-04-02603923-3",
        "d": "2-daily-2025-07-04",
        "t": 1751673293,
        "c": "c0d75171",
        "storedAt": 1751673294264
      }
    ],
    [
      "f5b685edc04f18803e9e6d336cbe3304ee244e7503dc4f435e0b75aa0166c2df",
      {
        "v": "42v2",
        "i": "2-msg-2025-07-04-02603923-4",
        "d": "2-daily-2025-07-04",
        "t": 1751673305,
        "c": "136ef443",
        "storedAt": 1751673306031
      }
    ],
    [
      "9b929504420e9a9ceaeae064d02ea9dd7a336326b04afc15831a57ca1bcf5210",
      {
        "v": "42v2",
        "i": "2-msg-2025-07-04-02603923-5",
        "d": "2-daily-2025-07-04",
        "t": 1751673315,
        "c": "a2dc69cc",
        "storedAt": 1751673315636
      }
    ]
  ],
  "contactKeys": [],
  "conversationStates": []
}






















async function publishGroupPost(memberPublicKeys, content) {
  // Generate ephemeral key for this post
  const postKey = generateRandomKey();
  
  // Encrypt content once
  const encryptedContent = encrypt(content, postKey);
  
  // Encrypt the post key for each member using ECDH
  const encryptedKeys = {};
  for (const memberPubKey of memberPublicKeys) {
    const sharedSecret = getSharedSecret(memberPubKey);
    encryptedKeys[memberPubKey] = encrypt(postKey, sharedSecret);
  }
  
  const post = {
    type: 'group',
    author: myPublicKey,
    encrypted: encryptedContent,
    keys: encryptedKeys, // Each member can decrypt their copy
    timestamp: Date.now()
  };
  
  await publishToBSV(post);
}